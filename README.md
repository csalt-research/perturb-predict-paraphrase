# Perturb, Predict & Paraphrase: Semi-supervised Learning using Noisy Student for Image Captioning

<p>
  <a href="https://www.ijcai.org/proceedings/2021/">
    <img src="https://img.shields.io/badge/IJCAI-2021-red">
  </a>
    <a href="https://www.ijcai.org/proceedings/2021/0105.pdf">
      <img src="http://img.shields.io/badge/Paper-PDF-brightgreen.svg">
  </a>
  <a href="https://media1.virtualchair.net/spaces/ijcai-2021/poster-pdfs/3496.pdf">
      <img src="http://img.shields.io/badge/Poster-PDF-green.svg">
  </a>
  <a href="https://drive.google.com/file/d/1SPyobkEsVaSB7CvEFAFGEPhMQ4HzhojS/view">
      <img src="http://img.shields.io/badge/Slides-PDF-ff9e18.svg">
  </a>
</p>

This repository includes the implementation of "Perturb, Predict & Paraphrase: Semi-supervised Learning using Noisy Student for Image Captioning" to appear in the Proceedings of IJCAI (30th International Joint Conference on Artificial Intelligence), 2021.

## Requirements

- Python 3.6
- Java 1.8.0
- PyTorch 1.0
- tensorboardX


## Training 

### Prepare data

Download the datafiles and follow instructions given [here](https://github.com/ruotianluo/self-critical.pytorch/tree/master/data)

### Start training

We have included a file pseudo_labels.txt which has the pseudo-labels generated by a teacher trained on 1% MSCOCO labeled data. This file can be used to train the student

```bash
$ CUDA_VISIBLE_DEVICES=0 sh train_student.sh
```

See `opts.py` for the options. 

### (Optional) Generate your own Pseudo Labels

To generate pseudo-labels, first train a teacher model using 

```bash
$ CUDA_VISIBLE_DEVICES=0 sh train_teacher.sh
```

Then, generate pseudo-labels using

```bash
$ CUDA_VISIBLE_DEVICES=0 sh get_pseudo_labels.sh
```

### Paraphraser

Refer to our paper for how to create a dataset for the paraphraser model. The code to train, and perform inference on the BART paraphraser can be found [here](https://github.com/ThilinaRajapakse/simpletransformers/tree/master/examples/seq2seq/paraphrasing). 

### 1M unlabeled images

Follow [https://github.com/ruotianluo/GoogleConceptualCaptioning](https://github.com/ruotianluo/GoogleConceptualCaptioning) for dataset creation and handling. 

## References
1. https://github.com/ruotianluo/self-critical.pytorch
2. https://github.com/husthuaan/AoANet
3. https://github.com/ruotianluo/GoogleConceptualCaptioning

## Citation

If you use this code for your research, please consider citing our work

```bibtex
@inproceedings{ijcai2021-105,
  title     = {Perturb, Predict & Paraphrase: Semi-Supervised Learning using Noisy Student for Image Captioning},
  author    = {Jain, Arjit and Reddy Samala, Pranay and Jyothi, Preethi and Mittal, Deepak and Singh, Maneesh},
  booktitle = {Proceedings of the Thirtieth International Joint Conference on
               Artificial Intelligence, {IJCAI-21}},
  publisher = {International Joint Conferences on Artificial Intelligence Organization},
  editor    = {Zhi-Hua Zhou},
  pages     = {758--764},
  year      = {2021},
  month     = {8},
  note      = {Main Track}
  doi       = {10.24963/ijcai.2021/105},
  url       = {https://doi.org/10.24963/ijcai.2021/105},
}

```
